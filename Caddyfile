manadia.wandanial.com {
	basic_auth /pub {
		owntracks OWNTRACKS_HASH_PLACEHOLDER
	}

	basic_auth /admin/* {
		admin ADMIN_HASH_PLACEHOLDER
	}

	# Dashboard (requires admin auth)
	basic_auth /dashboard* {
		admin ADMIN_HASH_PLACEHOLDER
	}

	# Redirect /dashboard to /dashboard/
	redir /dashboard /dashboard/ 301

	# Route dashboard to frontend service
	handle /dashboard/* {
		uri strip_prefix /dashboard
		reverse_proxy frontend:3000
	}

	# Dashboard API calls (requires admin auth, strips /api prefix)
	basic_auth /api/* {
		admin ADMIN_HASH_PLACEHOLDER
	}

	handle /api/* {
		uri strip_prefix /api
		reverse_proxy app:8000
	}

	# Route other calls to backend
	reverse_proxy /pub* app:8000
	reverse_proxy /admin* app:8000
	reverse_proxy /health* app:8000

	# Default route
	reverse_proxy app:8000
}